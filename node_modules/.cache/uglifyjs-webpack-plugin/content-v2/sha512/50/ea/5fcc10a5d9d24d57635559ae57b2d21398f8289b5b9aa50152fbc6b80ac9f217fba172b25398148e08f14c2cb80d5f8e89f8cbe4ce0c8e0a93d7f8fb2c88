{"code":"/*!\n * This software is licensed under a BSD license; see the LICENSE file for details.\n * \n *  - Version beta 0.4\n *  - Last Update:  2018, September 11\n *  - Major changes in beta 0.4:\n *     * Fixed a bug with FeedItems in group designs, no longer relies on latin squares (setItems now obsolete)\n *     * Fixed 'invalid format' bug with FeedItems(PennController.defaultTable)\n *     * FeedItems no longer gets overridden by later definitions of 'items'\n *     * FeedItems no longer generates items for non-running groups (preventing unnecessarily loading unused resources)\n *     * Fixed a bug that made selector.select inoperative\n *     * Fixed a bug that made selector.settings.once break selector.wait\n *     + Can now upload CSV tables directly to chunk_includes\n *     + Added a \"Loading, please wait\" message\n *     + Added .label to FeedItems, to define constant string labels (useful when reusing spreadsheets)\n *     + Added .setLabelColumn, .setGroupColumn and .setItemColumn to GetTable (setLabel, setGroup and setItem now deprecated)\n *     + Added log entries to report even when no element-specific event happen\n *     + Added element type Video\n *     + Added test command .index for Selector\n *     + Added options for scale.settings.log (last, first, etc.)\n */!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,\"__esModule\",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=57)}({0:function(e,t,n){\"use strict\";n.d(t,\"a\",function(){return i});var i={resources:{list:[],fetch:function(e,t,n){n=void 0==n|1==n;var s=i.resources.list.filter(t=>t.name==e&&t.controllers.indexOf(i.controllers.underConstruction.id)<0);if((s=s.length?s[0]:new class{constructor(e,t){this.name=e,this.value=e,this.creator=t,this.controllers=[],this.object=null,this.status=\"void\"}create(){this.status=\"pending\",this.creator.apply(this,[()=>this.resolve()])}resolve(){this.status=\"ready\"}}(e,t)).controllers.push(i.controllers.underConstruction.id),i.controllers.underConstruction.resources.push(s),\"void\"!=s.status)return s;if(s.creator=t,s.create(),n)for(let t in i.URLs)s.create.apply($.extend({},s,{value:i.URLs[t]+e,resolve:function(){\"ready\"!=s.status&&(s.object=this.object,s.resolve())}}));return i.resources.list.push(s),s}},controllers:{list:[],running:null,underConstruction:null},elements:{list:[]},URLs:[],utils:{}}},1:function(e,t,n){\"use strict\";function i(e){return()=>new Promise(async function(t){for(let t in e)if(e[t]instanceof Function)var n=await e[t]();t(n)})}function s(e){let t=[];return new Uint8Array(e).forEach(e=>{t.push(e.toString(16))}),t.join(\"\").toUpperCase()}function o(e){return e.match(/^00000[12]00/)?\"image/x-icon\":e.match(/424D/)?\"image/bmp\":e.match(/^89504E470D0A1A0A/)?\"image/png\":e.match(/^474946383[79]61/)?\"image/gif\":e.match(/^52494646........574542505650/)?\"image/webp\":e.match(/^FFD8FF/)?\"image/jpeg\":e.match(/^2E736E64/)?\"audio/basic\":e.match(/^464F524D........41494646/)?\"audio/aiff\":e.match(/^(fffb|494433)/)?\"audio/mpeg\":e.match(/^4F67675300/)?\"application/ogg\":e.match(/^4D546864......06/)?\"audio/midi\":e.match(/^52494646........41564920/)?\"video/avi\":e.match(/^52494646......(..)?57415645/)?\"audio/wave\":e.match(/^1A45DFA3/)?\"video/webm\":e.match(/^25504446/)?\"application/pdf\":!!e.match(/^504B0304/)&&\"application/zip\"}function r(e){let t=e/1e3%60,n=Math.trunc(e/6e4);return(n>0?n+\"min\":\"\")+(t>0?t+\"s\":\"\")}n.d(t,\"c\",function(){return i}),n.d(t,\"b\",function(){return s}),n.d(t,\"a\",function(){return o}),n.d(t,\"d\",function(){return r})},2:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"PennController\",function(){return u});var i=n(0),s=n(1);const o=6e4;let r=null,l=null;class a{constructor(){if(this.id=i.a.controllers.list.length,this.appendResultLine=[],this.linesToSave=[],this.resources=[],this.elements={},this.preloadDelay=o,i.a.controllers.list.push(this),this.defaultCommands={},this.headerDefaultCommands={},r&&r.defaultCommands)for(let e in r.defaultCommands)this.defaultCommands[e]=[].concat(r.defaultCommands[e])}_addElement(e,t){this.elements.hasOwnProperty(e)&&console.warn(\"Overriding another element with the same name (\"+e+\") in PennController #\"+this.id),this.elements[e]=t}_getElement(e){return this.elements[e]?this.elements[e]:console.warn(\"No element named \"+e+\" found for current controller\")}logAppend(e,t,n){return this.linesToSave.push([\"PennController\",this.id,e,t,Date.now(),n]),this}log(e,t){return void 0==t&&(t=e),this.appendResultLine.push([e,t]),this}noHeader(){return this.runHeader=!1,this}noFooter(){return this.runFooter=!1,this}setOption(e,t){this[e]=t}}i.a.controllers.underConstruction=new a,i.a.controllers.new=(()=>new a);var u=function(...e){let t=i.a.controllers.underConstruction,n=[];return function e(...t){for(let n in t)t[n]._promises?this.push(Object(s.c)(t[n]._promises)):t[n]instanceof Array&&e.apply(this,t[n])}.apply(n,e),t.sequence=Object(s.c)(n),i.a.controllers.underConstruction=new a,t};let h={};u.GetURLParameter=function(e){if(!Object.keys(h).length){let e=window.location.search.replace(\"?\",\"\").split(\"&\");for(let t in e)h[e[t].split(\"=\")[0]]=e[t].split(\"=\")[1]}if(h.hasOwnProperty(e))return h[e]},u.AddHost=function(...e){for(let t in e)\"string\"==typeof e[t]&&e[t].match(/^https?:\\/\\//i)?i.a.URLs.push(e[t]):console.warn(\"URL #\"+t+\" is not a valid URL (PennController.AddHost).\",e[t])},u.CheckPreloaded=function(...e){let t=new a;t.id=\"Preloader\",t.runHeader=!1,t.runFooter=!1,i.a.controllers.list.pop(),t.sequence=(()=>new Promise(e=>e())),t.ignoreWhenCheckingPreload=!0,e.length&&Number(e[e.length-1])>0&&(t.preloadDelay=Number(e[e.length-1]),e.length>1&&e.pop());let n=[];if(e.length)for(let t in e){let i=e[t];\"string\"==typeof i&&(i=(n=>n==e[t])),i instanceof Function&&n.push(i)}else n=[anyType];let s=window.modifyRunningOrder;return window.modifyRunningOrder=function(e){s instanceof Function&&(e=s.call(this,e));for(let i=0;i<e.length;i++){let s=e[i].filter(e=>{let t=!1;for(let i in n)t=t||n[i](e.type);t=(t=t&&\"PennController\"==e.controller)&&!e.options.ignoreWhenCheckingPreload});for(let e in s)t.resources=t.resources.concat(element[e].resources.filter(e=>t.resources.indexOf(e)<0))}return e},t},u.Header=function(...e){let t=i.a.controllers.underConstruction;t.id=\"Header\",i.a.controllers.list.pop(),t.sequence=Object(s.c)(e.map(e=>Object(s.c)(e._promises)));for(let e in t.defaultCommands)for(let n in t.defaultCommands[e])t.defaultCommands[e][n].push(\"header\");return r=t,i.a.controllers.underConstruction=new a,t},u.Footer=function(...e){let t=i.a.controllers.underConstruction;return t.id=\"Footer\",i.a.controllers.list.pop(),t.sequence=Object(s.c)(e.map(e=>Object(s.c)(e._promises))),l=t,i.a.controllers.underConstruction=new a,t},define_ibex_controller({name:\"PennController\",jqueryWidget:{_init:function(){var e=this;i.a.controllers.running=e,e.cssPrefix=e.options._cssPrefix,e.utils=e.options._utils,e.finishedCallback=e.options._finishedCallback,e.id=e.options.id,e.runHeader=void 0==e.options.runHeader|e.options.runHeader,e.runFooter=void 0==e.options.runFooter|e.options.runFooter;let t=e.options.preloadDelay,n=[];e.save=function(t,i,s,o,r,...l){l.length||(l=[\"NULL\"]);let a=[[\"PennElementType\",t],[\"PennElementName\",i],[\"Parameter\",s],[\"Value\",o],[\"EventTime\",r]];if(e.options.appendResultLine instanceof Array)for(let t in e.options.appendResultLine){let n=e.options.appendResultLine[t];n instanceof Array&&2==n.length&&a.push(n)}a.push([\"Comments\",l.join(\",\")]),n.push(a)};for(let t in e.options.linesToSave)e.save(e.options.linesToSave[t]);e.runHeader&&r instanceof a&&(e.options.resources=e.options.resources.concat(r.resources.filter(t=>e.options.resources.indexOf(t)<0)),$.extend(e.options.elements,r.elements)),e.runFooter&&l instanceof a&&(e.options.resources=e.options.resources.concat(l.resources.filter(t=>e.options.resources.indexOf(t)<0)),$.extend(e.options.elements,l.elements));let o=!1,u=async function(){if(!o){o=!0,e.runFooter&&l instanceof a&&(e.save(\"PennController\",e.id,\"_Footer_\",\"Start\",Date.now(),\"NULL\"),await l.sequence(),e.save(\"PennController\",e.id,\"_Footer_\",\"End\",Date.now(),\"NULL\"));for(let t in e.options.elements)e.options.elements[t].end();e.save(\"PennController\",e.id,\"_Trial_\",\"End\",Date.now(),\"NULL\"),n.sort((e,t)=>e[4][1]>t[4][1]),n.map(e=>{for(let t in e)e[t][1]instanceof Function?e[t][1]=e[t][1]():e[t][1]&&\"Var\"==e[t][1].type&&(e[t][1]=e[t][1].value)}),e.finishedCallback(n)}};e.endTrial=u;let h=!1,c=async function(t){if(!h){if(h=!0,t)for(let t in e.options.resources.filter(e=>\"ready\"!=e.status))e.save(\"PennController\",e.id,\"_PreloadFailed_\",csv_url_encode(e.options.resources[t].name),Date.now(),\"NULL\");e.save(\"PennController\",e.id,\"_Trial_\",\"Start\",Date.now(),\"NULL\"),e.runHeader&&r instanceof a&&(e.save(\"PennController\",e.id,\"_Header_\",\"Start\",Date.now(),\"NULL\"),await r.sequence(),e.save(\"PennController\",e.id,\"_Header_\",\"End\",Date.now(),\"NULL\")),d.remove(),e.options.sequence().then(u)}},d=$(\"<div><p>Please wait while the resources are preloading</p><p>This may take up to \"+Object(s.d)(t)+\".</p></div>\");e.element.append(d);for(let t in e.options.resources){let n=e.options.resources[t],i=n.resolve;\"ready\"!=n.status&&(n.resolve=function(){i.apply(n),0==e.options.resources.filter(e=>\"ready\"!=e.status).length&&c()})}0==e.options.resources.filter(e=>\"ready\"!=e.status).length?c():setTimeout(function(){c(!0)},t)}},properties:{obligatory:[],countsForProgressBar:!0,htmlDescription:null}})},57:function(e,t,n){(function(e){e._AddElementType(\"Youtube\",function(e){const t=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;let n=[];$(document).ready(function(){let e=document.createElement(\"script\");e.src=\"https://www.youtube.com/iframe_api\";let t=document.getElementsByTagName(\"script\")[0];t.parentNode.insertBefore(e,t),window.onYouTubeIframeAPIReady=function(){for(let e in n)n[e].call()}}),this.immediate=function(t,i,s){i&&\"string\"==typeof i||console.error(\"Invalid code for Youtube element \"+t,i),s=s&&!s.match(/^\\W*no\\W*controls?\\W*$/i)?1:0,this.resource=e.resources.fetch(i,function(t){let o=i+\"-\"+e.resources.list.length;this.ended=function(){},this.playing=function(){},this.paused=function(){},this.buffering=function(){};let r=!1,l=$(\"<iframe>\");l.attr({src:\"https://www.youtube-nocookie.com/embed/\"+i+\"?enablejsapi=1&controls=\"+s,id:o,frameborder:0}).bind(\"load\",()=>r=!0).css({display:\"none\",position:\"absolute\"}),$(document).ready(()=>$(document.body).append(l)),n.push(()=>{let e=!0,n=()=>this.player=new YT.Player(o,{playerVars:{controls:s},events:{onReady:e=>{l=e.target.cueVideoById(i),e.target.playVideo()},onStateChange:n=>{n.data!=YT.PlayerState.ENDED||e?n.data==YT.PlayerState.PLAYING?e?(n.target.pauseVideo(),n.target.seekTo(0),e=!1,t()):this.playing(n):n.data!=YT.PlayerState.PAUSED||e?n.data!=YT.PlayerState.BUFFERING||e||this.buffering(n):this.paused(n):this.ended(n)}}});r?n():l.bind(\"load\",n)}),this.object=l},!1)},this.uponCreation=function(e){this.iframe=this.resource.object,this.player=this.resource.player,this.log=!1,this.hasPlayed=!1,this.events=[],this.onplay=(()=>this.events.push([\"Play\",this.player.getCurrentTime(),Date.now(),\"NULL\"])),this.onpause=(()=>this.events.push([\"Pause\",this.player.getCurrentTime(),Date.now(),\"NULL\"])),this.onbuffer=(()=>this.events.push([\"Buffer\",this.player.getCurrentTime(),Date.now(),\"NULL\"])),this.onend=(()=>{this.hasPlayed=!0,this.events.push([\"End\",this.player.getCurrentTime(),Date.now(),\"NULL\"])});let t=this,n=this.resource.ended;this.resource.ended=function(e){n.apply(this,e),t.onend()};let i=this.resource.playing;this.resource.playing=function(e){i.apply(this,e),t.onplay()};let s=this.resource.paused;this.resource.paused=function(e){s.apply(this,e),t.onpause()};let o=this.resource.buffering;this.resource.buffering=function(e){o.apply(this,e),t.onbuffer()},this.jQueryElement=$(\"<div>\").css(\"display\",\"inline-block\"),this.visual={top:0,left:0,width:this.iframe.width(),height:this.iframe.height()},this.jQueryElement.css({width:this.visual.width,height:this.visual.height}),this.player.seekTo(0),this.disabled=!1,this.jQueryDisable=null,this.printDisable=(()=>{this.jQueryDisable instanceof jQuery&&this.jQueryDisable.remove(),this.jQueryDisable=$(\"<div>\").css({position:\"absolute\",display:\"inline-block\",\"background-color\":\"gray\",opacity:.5,width:this.jQueryElement.width(),height:this.jQueryElement.height()}),this.jQueryElement.before(this.jQueryDisable),this.jQueryElement.addClass(\"PennController-\"+this.type+\"-disabled\")}),e()},this.end=function(){if(this.observer instanceof t&&this.observer.disconnect(),this.player&&this.player.getPlayerState()==YT.PlayerState.PLAYING&&this.player.pauseVideo(),this.iframe.css(\"display\",\"none\"),this.jQueryDisable&&this.jQueryDisable.remove(),this.log&&this.log instanceof Array)if(this.events.length)if(this.log.indexOf(\"all\")>-1)for(let t in this.events)e.controllers.running.save(this.type,this.id,...this.events[t]);else{if(this.log.indexOf(\"play\")>-1){let t=this.events.filter(e=>\"Play\"==e[0]);for(let n in t)e.controllers.running.save(this.type,this.id,...t[n])}if(this.log.indexOf(\"end\")>-1){let t=this.events.filter(e=>\"End\"==e[0]);for(let n in t)e.controllers.running.save(this.type,this.id,...t[n])}if(this.log.indexOf(\"pause\")>-1){let t=this.events.filter(e=>\"Pause\"==e[0]);for(let n in t)e.controllers.running.save(this.type,this.id,...t[n])}if(this.log.indexOf(\"buffer\")>-1){let t=this.events.filter(e=>\"Buffer\"==e[0]);for(let n in t)e.controllers.running.save(this.type,this.id,...t[n])}}else e.controllers.running.save(this.type,this.id,\"play\",\"NA\",\"Never\",\"The video was never played during the trial\")},this.value=function(){return this.hasPlayed},this.actions={play:function(e){this.player.playVideo(),e()},pause:function(e){this.player.pauseVideo(),e()},print:function(n,i){e.elements.standardCommands.actions.print.apply(this,[()=>{let e=this.jQueryElement.offset();this.iframe.css({position:\"absolute\",left:e.left,top:e.top,display:\"inline-block\"}),this.observer=new t(()=>{if(this.jQueryElement[0].offsetParent&&$.contains(document.body,this.jQueryElement[0])){this.iframe.css(\"display\",this.jQueryElement.css(\"display\"));let e=this.jQueryElement.width(),t=this.jQueryElement.height();e==this.visual.width&&t==this.visual.height||(this.iframe.css({width:e,height:t}),this.visual.width=e,this.visual.height=t);let n=this.jQueryElement.offset();n.left==this.visual.left&&n.top==this.visual.top||(this.iframe.css({left:n.left,top:n.top}),this.visual.left=n.left,this.visual.top=n.top),this.observer.disconnect(),this.observer.observe(this.jQueryElement.parent()[0],{childList:!0,attributes:!0,subtree:!0})}else this.iframe.css(\"display\",\"none\")}),this.observer.observe(this.jQueryElement.parent()[0],{childList:!0,attributes:!0,subtree:!0}),this.disabled&&this.printDisable(),n()},i])},remove:function(t){this.iframe.css(\"display\",\"none\"),e.elements.standardCommands.actions.remove.apply(this,[t])},stop:function(e){this.player.playVideo(),this.player.seekTo(0),e()},wait:function(e,t){if(\"first\"==t&&this.hasPlayed)e();else{let n=!1,i=this.onend;this.onend=function(...s){i.apply(this,s),n||(t instanceof Object&&t._runPromises&&t.success?t._runPromises().then(t=>{\"success\"==t&&(n=!0,e())}):(n=!0,e()))}}}},this.settings={disable:function(e){this.printDisable(),this.disabled=!0,e()},enable:function(e){this.jQueryDisable instanceof jQuery&&(this.disabled=!1,this.jQueryDisable.remove(),this.jQueryDisable=null,this.jQueryElement.removeClass(\"PennController-\"+this.type+\"-disabled\")),e()},once:function(e){if(this.hasPlayed)this.disabled=!0;else{let e=this.onend,t=this;this.onend=function(...n){e.apply(this,n),t.disabled=!0,t.printDisable()}}e()},log:function(e,...t){t.length?this.log=t:this.log=[\"play\"],e()},size:function(t,n,i){e.elements.standardCommands.settings.size.apply(this,[()=>{this.iframe.css({width:n,height:i}),this.visual.width=n,this.visual.height=i,t()},n,i])}},this.test={hasPlayed:function(){return this.hasPlayed},playing:function(){return 1==this.player.getPlayerState()}}})}).call(this,n(2).PennController)}});","extractedComments":[]}